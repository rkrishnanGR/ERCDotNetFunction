using Xunit;
using Amazon.Lambda.Core;
using Amazon.Lambda.TestUtilities;

namespace ERCDotNetFunction.Tests;

public class FunctionTest
{
    [Fact]
    public async void TestToUpperFunction()
    {
        var function = new Function();
        var context = new TestLambdaContext();
        Event eventData = new Event();
        eventData.Detail = new Detail();

        eventData.Detail.Body = "{\n  \"Type\" : \"Notification\",\n  \"MessageId\" : \"6c5c562f-a719-51cf-9029-0b1caf9d8462\",\n  \"TopicArn\" : \"arn:aws:sns:us-east-1:558229852135:esp-event-prate-dev\",\n  \"Subject\" : \"entity-under-two-year-employment\",\n  \"Message\" : \"{\\n  \\\"triggered\\\": true,\\n  \\\"name\\\": \\\"entity-under-two-year-employment\\\",\\n  \\\"loan-number\\\": \\\"980121780289DEV\\\",\\n  \\\"msg\\\": {\\n    \\\"event-header\\\": {\\n      \\\"partner\\\": \\\"n/a\\\",\\n      \\\"encompass-lastmodified\\\": \\\"2023-07-13T18:47:27.420Z\\\",\\n      \\\"loan-number\\\": \\\"980121780289DEV\\\",\\n      \\\"loan-tenant\\\": \\\"prate\\\",\\n      \\\"user-id\\\": \\\"oneloanapp\\\",\\n      \\\"source\\\": \\\"encompass\\\",\\n      \\\"env\\\": \\\"prate-dev\\\",\\n      \\\"borr-last-name\\\": \\\"ANDERSON\\\",\\n      \\\"borrower-pairs\\\": [\\n        {\\n          \\\"borr-first-name\\\": \\\"Mobile\\\",\\n          \\\"borr-last-name\\\": \\\"ANDERSON\\\",\\n          \\\"borr-email\\\": \\\"perf@home.com\\\",\\n          \\\"co-borr-first-name\\\": \\\"M2\\\",\\n          \\\"co-borr-last-name\\\": \\\"Perf2\\\",\\n          \\\"co-borr-email\\\": \\\"M2@home.com\\\"\\n        }\\n      ],\\n      \\\"urla-version\\\": \\\"2020\\\",\\n      \\\"loan-owner\\\": \\\"prate\\\",\\n      \\\"team\\\": [\\n        {\\n          \\\"role\\\": \\\"pm\\\",\\n          \\\"userid\\\": null,\\n          \\\"email\\\": null\\n        },\\n        {\\n          \\\"role\\\": \\\"lo\\\",\\n          \\\"userid\\\": null,\\n          \\\"email\\\": null\\n        },\\n        {\\n          \\\"role\\\": \\\"lc\\\",\\n          \\\"userid\\\": null,\\n          \\\"email\\\": null\\n        },\\n        {\\n          \\\"role\\\": \\\"mc\\\",\\n          \\\"userid\\\": null,\\n          \\\"email\\\": null\\n        },\\n        {\\n          \\\"role\\\": \\\"sa\\\",\\n          \\\"userid\\\": null,\\n          \\\"email\\\": null\\n        },\\n        {\\n          \\\"role\\\": \\\"uw\\\",\\n          \\\"userid\\\": null,\\n          \\\"email\\\": null\\n        },\\n        {\\n          \\\"role\\\": \\\"loan-closer\\\",\\n          \\\"userid\\\": null,\\n          \\\"email\\\": null\\n        },\\n        {\\n          \\\"role\\\": \\\"oa-mc\\\",\\n          \\\"userid\\\": null,\\n          \\\"email\\\": null\\n        },\\n        {\\n          \\\"role\\\": \\\"oa-lc\\\",\\n          \\\"userid\\\": null,\\n          \\\"email\\\": null\\n        },\\n        {\\n          \\\"role\\\": \\\"oa-cc\\\",\\n          \\\"userid\\\": null,\\n          \\\"email\\\": null\\n        },\\n        {\\n          \\\"role\\\": \\\"oa-s\\\",\\n          \\\"userid\\\": null,\\n          \\\"email\\\": null\\n        }\\n      ],\\n      \\\"loan-guid\\\": \\\"3d0afb3f-c4c2-47c6-a48d-0caec77ddc20\\\",\\n      \\\"version\\\": 2,\\n      \\\"prev-version\\\": 1,\\n      \\\"company\\\": \\\"prate\\\"\\n    },\\n    \\\"details\\\": [\\n      {\\n        \\\"entitiy-type\\\": \\\"borrower\\\",\\n        \\\"entity-email\\\": \\\"perf@home.com\\\"\\n      }\\n    ]\\n  },\\n  \\\"created\\\": \\\"2023-07-13T18:47:40.343Z\\\",\\n  \\\"source\\\": \\\"encompass\\\",\\n  \\\"env\\\": \\\"prate-dev\\\",\\n  \\\"loan-version\\\": 2,\\n  \\\"id\\\": 4767522,\\n  \\\"loan-guid\\\": \\\"3d0afb3f-c4c2-47c6-a48d-0caec77ddc20\\\"\\n}\",\n  \"Timestamp\" : \"2023-07-20T10:02:44.856Z\",\n  \"SignatureVersion\" : \"1\",\n  \"Signature\" : \"LO6PM/xxU+6FucRHS+hn3zQYjfGURayqlJxslRLTMMW1JaiK/fZ3fBQ6Gp+SDsDM+N5NgkdtYnNkZh1eC3WRAvQvaw8CQ6Qgh4QQAgx8kiX+j06SabhUqj9z+Gdp7Eg8MChC21wKC+9W/deFs4hYIbb6TDROl95YfN1/g+S7DS/6x9F+3EFi9E0p9tGaiMRtWJ0wq1NgoKG8gBi4ihlJj+E8FWeO9RiSkYVVXVcDAHesWwKKLIfMJkDcPcReuot6bSVf/XZJxJe2YEOJXJAw9dX7P1VEE0HMOJi9MPjJi/cyRAnURBRRQ65Th5SbXxvzbEOYS+GThEWeRefDYWeNzw==\",\n  \"SigningCertURL\" : \"https://sns.us-east-1.amazonaws.com/SimpleNotificationService-01d088a6f77103d0fe307c0069e40ed6.pem\",\n  \"UnsubscribeURL\" : \"https://sns.us-east-1.amazonaws.com/?Action=Unsubscribe&SubscriptionArn=arn:aws:sns:us-east-1:558229852135:esp-event-prate-dev:d490e250-0dad-4287-93d2-2362ee47d135\"\n}";
        var result = await function.FunctionHandler(eventData, context);
        Assert.NotNull(result);
    }
}
